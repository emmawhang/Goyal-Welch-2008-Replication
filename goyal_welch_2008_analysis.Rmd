---
title: "Goyal & Welch (2008): A Comprehensive Look at Equity Premium Prediction"
author: "Replication Analysis - Extended to 2018"
date: "`r Sys.Date()`"
output:
  html_document:
    toc: true
    toc_float: true
    theme: cosmo
    code_folding: show
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE, fig.width = 10, fig.height = 6)
```

# 1. Introduction

## 1.1 Paper Overview

This notebook replicates the analysis from **Goyal, A., & Welch, I. (2008)**. *"A Comprehensive Look at The Empirical Performance of Equity Premium Prediction."* Review of Financial Studies, 21(4), 1455-1508.

**Key Question:** Do commonly used financial variables have genuine out-of-sample predictive power for equity returns?

**Main Finding:** While many predictors show strong **in-sample** performance, they fail to predict returns **out-of-sample**, suggesting that apparent predictability may be spurious.

## 1.2 Methodology

The paper tests 16 predictor variables using two approaches:

1. **Historical Mean Model** (Naive Baseline): Predicts returns using the historical average
2. **OLS Regression Model**: Uses lagged predictor variables to forecast returns

Performance is evaluated through:
- **In-Sample (IS)**: Fit to historical data (1872-2005)
- **Out-of-Sample (OOS)**: Recursive forecasting using only information available at forecast time

---

# 2. Setup & Data Loading

## 2.1 Load Required Packages

```{r load-packages}
library(data.table)
library(tidyverse)
library(lubridate)
library(magrittr)
library(dyn)
library(reshape2)
library(formattable)
library(sparkline)
library(xtable)
library(DT)
library(htmltools)
library(dplyr)
library(tidyr)
```

## 2.2 Import Data

We use two datasets:
- **annual_2018.csv**: Extended data through 2018
- **annual_2005_goyal_welch.csv**: Original paper results for comparison

```{r load-data}
# Load annual financial data
annual <- fread(file.path("Data/annual_2018.csv"))

# Load original G&W 2005 results for comparison
table1_2005_g_w <- fread(file.path("Data/annual_2005_goyal_welch.csv"))

# Preview the data structure
cat("Data dimensions:", dim(annual)[1], "observations,", dim(annual)[2], "variables\n")
head(annual[, .(yyyy, Index, D12, Rfree, tbl)])
```

---

# 3. Variable Construction

## 3.1 Predictor Variables

Following Goyal & Welch (2008), we construct 16 predictor variables from the raw data.

### 3.1.1 Default Spreads

**Default Yield Spread (dfy)**: Difference between BAA and AAA-rated corporate bond yields

```{r var-dfy}
annual <- annual[, dfy := BAA - AAA]
```

**Default Return Spread (dfr)**: Difference between long-term corporate and government bonds

```{r var-dfr}
annual <- annual[, dfr := corpr - ltr]
```

### 3.1.2 Stock Returns and Valuations

**Stock Returns with Dividends (IndexDiv)**

```{r var-indexdiv}
annual$Index <- as.numeric(annual$Index)
annual <- annual[, IndexDiv := Index + D12]
```

**Dividend-Price Ratio (dp)**: $\ln(D_{12}) - \ln(P)$

```{r var-dp}
annual <- annual[, dp := log(D12) - log(Index)]
```

**Dividend Yield (dy)**: $\ln(D_{12,t}) - \ln(P_{t-1})$

```{r var-dy}
vec_dy <- c(NA, annual[2:nrow(annual), log(D12)] - annual[1:(nrow(annual) - 1), log(Index)])
annual <- annual[, dy := vec_dy]
```

**Earnings-Price Ratio (ep)**: $\ln(E_{12}) - \ln(P)$

```{r var-ep}
annual <- annual[, ep := log(E12) - log(Index)]
```

**Dividend Payout Ratio (de)**: $\ln(D_{12}) - \ln(E_{12})$

```{r var-de}
annual <- annual[, de := log(D12) - log(E12)]
```

### 3.1.3 Interest Rates and Spreads

**Log Risk-Free Rate (logRfree)**

```{r var-logRfree}
annual <- annual[, logRfree := log(Rfree + 1)]
```

**Term Spread (tms)**: Long-term yield minus T-bill rate

```{r var-tms}
annual <- annual[, tms := lty - tbl]
```

### 3.1.4 Return Variables

**Log Return** and **Log Return with Dividends**

```{r var-returns}
annual <- annual[, logret := c(NA, diff(log(Index)))]

vec_logretdiv <- c(NA, log(annual[2:nrow(annual), IndexDiv] / annual[1:(nrow(annual) - 1), Index]))
annual <- annual[, logretdiv := vec_logretdiv]
```

**Equity Risk Premium (rp_div)**: Log return with dividends minus log risk-free rate

```{r var-rp}
annual <- annual[, rp_div := logretdiv - logRfree]
```

---

# 4. Time Series Visualization

## 4.1 Create Time Series Object

```{r create-ts}
ts_annual <- ts(annual, start = annual[1, yyyy], end = annual[nrow(annual), yyyy])
```

## 4.2 Plot Key Variables

```{r plot-ts, fig.height=8}
plot(ts_annual[, c("rp_div", "dp", "dy")], 
     main = "Equity Premium, Dividend-Price Ratio, and Dividend Yield (1872-2018)")
```

---

# 5. Statistical Functions

## 5.1 Main Function: In-Sample and Out-of-Sample Analysis

This function implements the core methodology from the paper:

**Parameters:**
- `ts_df`: Time series data frame
- `indep`: Independent variable (predictor)
- `dep`: Dependent variable (equity premium)
- `start`, `end`: Sample period
- `est_periods_OOS`: Number of initial observations for first OOS forecast

**Returns:**
- In-sample and out-of-sample errors
- R² and adjusted R² statistics
- RMSE differences
- Cumulative SSE difference plots

```{r function-statistics}
get_statistics <- function(ts_df, indep, dep, h = 1, start = 1872, end = 2005, est_periods_OOS = 20) {
  
  # ===== IN-SAMPLE ANALYSIS =====
  
  # Historical mean model (naive benchmark)
  avg <- mean(window(ts_df, start, end)[, dep], na.rm = TRUE)
  IS_error_N <- (window(ts_df, start, end)[, dep] - avg)
  
  # OLS regression using lagged predictor
  reg <- dyn$lm(eval(parse(text = dep)) ~ stats::lag(eval(parse(text = indep)), -1), 
                data = window(ts_df, start, end))
  IS_error_A <- reg$residuals
  
  # ===== OUT-OF-SAMPLE ANALYSIS =====
  
  # Initialize error vectors
  OOS_error_N <- numeric(end - start - est_periods_OOS)
  OOS_error_A <- numeric(end - start - est_periods_OOS)
  
  # Recursive forecasting: use only information available at forecast time
  j <- 0
  for (i in (start + est_periods_OOS):(end - 1)) {
    j <- j + 1
    
    # Actual equity risk premium to predict
    actual_ERP <- as.numeric(window(ts_df, i + 1, i + 1)[, dep])
    
    # Historical mean forecast
    OOS_error_N[j] <- actual_ERP - mean(window(ts_df, start, i)[, dep], na.rm = TRUE)
    
    # OLS forecast using data up to time i
    reg_OOS <- dyn$lm(eval(parse(text = dep)) ~ stats::lag(eval(parse(text = indep)), -1), 
                      data = window(ts_df, start, i))
    df <- data.frame(x = as.numeric(window(ts_df, i, i)[, indep]))
    names(df) <- indep
    pred_ERP <- predict.lm(reg_OOS, newdata = df)
    OOS_error_A[j] <- pred_ERP - actual_ERP
  }
  
  # ===== PERFORMANCE METRICS =====
  
  # Mean Squared Errors
  MSE_N <- mean(OOS_error_N^2)
  MSE_A <- mean(OOS_error_A^2)
  
  # Out-of-sample R-squared
  OOS_R2 <- 1 - MSE_A / MSE_N
  
  # Adjusted R-squared
  OOS_aR2 <- 1 - (((1 - OOS_R2) * (reg_OOS$df.residual)) / (reg_OOS$df.residual - 1))
  
  # Delta RMSE (positive = OLS beats historical mean)
  dRMSE <- sqrt(MSE_N) - sqrt(MSE_A)
  
  # ===== CREATE VISUALIZATION =====
  
  # Cumulative SSE differences
  IS <- cumsum(IS_error_N[2:length(IS_error_N)]^2) - cumsum(IS_error_A^2)
  OOS <- cumsum(OOS_error_N^2) - cumsum(OOS_error_A^2)
  
  df <- data.frame(
    x = seq.int(from = start + 1 + est_periods_OOS, to = end),
    IS = IS[(1 + est_periods_OOS):length(IS)],
    OOS = OOS
  )
  
  # Shift IS line to start at zero
  df$IS <- df$IS - df$IS[1]
  df <- melt(df, id.var = "x")
  
  plotGG <- ggplot(df) +
    geom_line(aes(x = x, y = value, color = variable)) +
    geom_rect(data = data.frame(), 
              aes(xmin = 1974, xmax = 1975, ymin = -0.2, ymax = 0.2),
              fill = "red", alpha = 0.1) +
    annotate(geom = "text", x = 1973, y = 0.15, label = "Oil Shock", 
             color = "Black", angle = 90, size = 3) +
    annotate(geom = "text", x = 1976, y = 0.15, label = "1974", 
             color = "Black", angle = 90, size = 3) +
    scale_x_continuous("Year") +
    scale_y_continuous("Cumulative SSE Difference", limits = c(-0.2, 0.2)) +
    theme_minimal()
  
  # Return all results
  return(list(
    IS_error_N = IS_error_N,
    IS_error_A = reg$residuals,
    OOS_error_N = OOS_error_N,
    OOS_error_A = OOS_error_A,
    IS_R2 = summary(reg)$r.squared,
    IS_aR2 = summary(reg)$adj.r.squared,
    OOS_R2 = OOS_R2,
    OOS_aR2 = OOS_aR2,
    dRMSE = dRMSE,
    OOS_MSE_N = MSE_N,
    OOS_MSE_A = MSE_A,
    plotGG = plotGG
  ))
}
```

## 5.2 Alternative Function for Stock Variance

Stock variance requires different y-axis scaling for visualization.

```{r function-statistics2}
get_statistics2 <- function(ts_df, indep, dep, h = 1, start = 1872, end = 2005, est_periods_OOS = 20) {
  # Same implementation as get_statistics but with different plot limits
  # [Function body identical to above, just changing y-axis limits to c(-1.0, 0.2)]
  
  # [Code omitted for brevity - identical to get_statistics except plot y-limits]
  avg <- mean(window(ts_df, start, end)[, dep], na.rm = TRUE)
  IS_error_N <- (window(ts_df, start, end)[, dep] - avg)
  reg <- dyn$lm(eval(parse(text = dep)) ~ stats::lag(eval(parse(text = indep)), -1), 
                data = window(ts_df, start, end))
  IS_error_A <- reg$residuals
  
  OOS_error_N <- numeric(end - start - est_periods_OOS)
  OOS_error_A <- numeric(end - start - est_periods_OOS)
  
  j <- 0
  for (i in (start + est_periods_OOS):(end - 1)) {
    j <- j + 1
    actual_ERP <- as.numeric(window(ts_df, i + 1, i + 1)[, dep])
    OOS_error_N[j] <- actual_ERP - mean(window(ts_df, start, i)[, dep], na.rm = TRUE)
    reg_OOS <- dyn$lm(eval(parse(text = dep)) ~ stats::lag(eval(parse(text = indep)), -1), 
                      data = window(ts_df, start, i))
    df <- data.frame(x = as.numeric(window(ts_df, i, i)[, indep]))
    names(df) <- indep
    pred_ERP <- predict.lm(reg_OOS, newdata = df)
    OOS_error_A[j] <- pred_ERP - actual_ERP
  }
  
  MSE_N <- mean(OOS_error_N^2)
  MSE_A <- mean(OOS_error_A^2)
  OOS_R2 <- 1 - MSE_A / MSE_N
  OOS_aR2 <- 1 - (((1 - OOS_R2) * (reg_OOS$df.residual)) / (reg_OOS$df.residual - 1))
  dRMSE <- sqrt(MSE_N) - sqrt(MSE_A)
  
  IS <- cumsum(IS_error_N[2:length(IS_error_N)]^2) - cumsum(IS_error_A^2)
  OOS <- cumsum(OOS_error_N^2) - cumsum(OOS_error_A^2)
  df <- data.frame(x = seq.int(from = start + 1 + est_periods_OOS, to = end),
                   IS = IS[(1 + est_periods_OOS):length(IS)], OOS = OOS)
  df$IS <- df$IS - df$IS[1]
  df <- melt(df, id.var = "x")
  
  plotGG <- ggplot(df) +
    geom_line(aes(x = x, y = value, color = variable)) +
    geom_rect(data = data.frame(), 
              aes(xmin = 1973, xmax = 1975, ymin = -1.0, ymax = 0.2),
              fill = "red", alpha = 0.1) +
    annotate(geom = "text", x = 1972, y = 0.15, label = "Oil Shock", 
             color = "Black", angle = 90, size = 3) +
    annotate(geom = "text", x = 1976, y = 0.15, label = "1974", 
             color = "Black", angle = 90, size = 3) +
    scale_x_continuous("Year") +
    scale_y_continuous("Cumulative SSE Difference", limits = c(-1.0, 0.2)) +
    theme_minimal()
  
  return(list(
    IS_R2 = summary(reg)$r.squared,
    IS_aR2 = summary(reg)$adj.r.squared,
    OOS_R2 = OOS_R2,
    OOS_aR2 = OOS_aR2,
    dRMSE = dRMSE,
    OOS_MSE_N = MSE_N,
    OOS_MSE_A = MSE_A,
    plotGG = plotGG
  ))
}
```

---

# 6. Results: Valuation Ratios

## 6.1 Dividend-Price Ratio (d/p)

```{r dp-analysis}
dp_stat <- get_statistics(ts_annual, "dp", "rp_div", start = 1872)
dp_stat$plotGG + ggtitle("Dividend-Price Ratio (dp)") + 
  theme(plot.title = element_text(hjust = 0.5))
```

**Results:**
- In-sample R²: `r round(dp_stat$IS_aR2 * 100, 2)`%
- Out-of-sample R²: `r round(dp_stat$OOS_aR2 * 100, 2)`%
- Delta RMSE: `r round(dp_stat$dRMSE * 100, 2)`%

## 6.2 Dividend Yield (d/y)

```{r dy-analysis}
dy_stat <- get_statistics(ts_annual, "dy", "rp_div", start = 1872)
dy_stat$plotGG + ggtitle("Dividend Yield (dy)") + 
  theme(plot.title = element_text(hjust = 0.5))
```

## 6.3 Earnings-Price Ratio (e/p)

```{r ep-analysis}
ep_stat <- get_statistics(ts_annual, "ep", "rp_div", start = 1872)
ep_stat$plotGG + ggtitle("Earnings-Price Ratio (ep)") + 
  theme(plot.title = element_text(hjust = 0.5))
```

## 6.4 Dividend Payout Ratio (d/e)

```{r de-analysis}
de_stat <- get_statistics(ts_annual, "de", "rp_div", start = 1872)
de_stat$plotGG + ggtitle("Dividend Payout Ratio (de)") + 
  theme(plot.title = element_text(hjust = 0.5))
```

---

# 7. Results: Interest Rates and Spreads

## 7.1 Treasury Bill Rate (tbl)

```{r tbl-analysis}
tbl_stat <- get_statistics(ts_annual, "tbl", "rp_div", start = 1920)
tbl_stat$plotGG + ggtitle("Treasury Bill Rate (tbl)") + 
  theme(plot.title = element_text(hjust = 0.5))
```

## 7.2 Long-Term Yield (lty)

```{r lty-analysis}
lty_stat <- get_statistics(ts_annual, "lty", "rp_div", start = 1919)
lty_stat$plotGG + ggtitle("Long-Term Yield (lty)") + 
  theme(plot.title = element_text(hjust = 0.5))
```

## 7.3 Term Spread (tms)

```{r tms-analysis}
tms_stat <- get_statistics(ts_annual, "tms", "rp_div", start = 1920)
tms_stat$plotGG + ggtitle("Term Spread (tms)") + 
  theme(plot.title = element_text(hjust = 0.5))
```

## 7.4 Default Yield Spread (dfy)

```{r dfy-analysis}
dfy_stat <- get_statistics(ts_annual, "dfy", "rp_div", start = 1919)
dfy_stat$plotGG + ggtitle("Default Yield Spread (dfy)") + 
  theme(plot.title = element_text(hjust = 0.5))
```

## 7.5 Default Return Spread (dfr)

```{r dfr-analysis}
dfr_stat <- get_statistics(ts_annual, "dfr", "rp_div", start = 1926)
dfr_stat$plotGG + ggtitle("Default Return Spread (dfr)") + 
  theme(plot.title = element_text(hjust = 0.5))
```

---

# 8. Results: Other Predictors

## 8.1 Stock Variance (svar)

```{r svar-analysis}
svar_stat <- get_statistics2(ts_annual, "svar", "rp_div", start = 1885)
svar_stat$plotGG + ggtitle("Stock Variance (svar)") + 
  theme(plot.title = element_text(hjust = 0.5))
```

## 8.2 Long-Term Return (ltr)

```{r ltr-analysis}
ltr_stat <- get_statistics(ts_annual, "ltr", "rp_div", start = 1926)
ltr_stat$plotGG + ggtitle("Long-Term Return (ltr)") + 
  theme(plot.title = element_text(hjust = 0.5))
```

## 8.3 Inflation (infl)

```{r infl-analysis}
infl_stat <- get_statistics(ts_annual, "infl", "rp_div", start = 1919)
infl_stat$plotGG + ggtitle("Inflation (infl)") + 
  theme(plot.title = element_text(hjust = 0.5))
```

## 8.4 Book-to-Market Ratio (b/m)

```{r bm-analysis}
bm_stat <- get_statistics(ts_annual, "bm", "rp_div", start = 1921)
bm_stat$plotGG + ggtitle("Book to Market (bm)") + 
  theme(plot.title = element_text(hjust = 0.5))
```

## 8.5 Investment-Capital Ratio (i/k)

```{r ik-analysis}
ik_stat <- get_statistics(ts_annual, "ik", "rp_div", start = 1947)
ik_stat$plotGG + ggtitle("Investment-Capital Ratio (ik)") + 
  theme(plot.title = element_text(hjust = 0.5))
```

## 8.6 Net Equity Expansion (ntis)

```{r ntis-analysis}
ntis_stat <- get_statistics(ts_annual, "ntis", "rp_div", start = 1927)
ntis_stat$plotGG + ggtitle("Net Equity Expansion (ntis)") + 
  theme(plot.title = element_text(hjust = 0.5))
```

## 8.7 Equity Issuing (eqis)

```{r eqis-analysis}
eqis_stat <- get_statistics(ts_annual, "eqis", "rp_div", start = 1927)
eqis_stat$plotGG + ggtitle("Percent Equity Issuing (eqis)") + 
  theme(plot.title = element_text(hjust = 0.5))
```

---

# 9. Summary Tables

## 9.1 Table 1: Main Results (2018 Data)

```{r table1-create}
table1 <- tibble(
  Variable = c("dfy", "infl", "svar", "d/e", "lty", "tms", "tbl", "dfr", 
               "d/p", "d/y", "ltr", "e/p", "b/m", "i/k", "ntis", "eqis"),
  
  IS_aR2 = c(
    dfy_stat$IS_aR2, infl_stat$IS_aR2, svar_stat$IS_aR2, de_stat$IS_aR2,
    lty_stat$IS_aR2, tms_stat$IS_aR2, tbl_stat$IS_aR2, dfr_stat$IS_aR2,
    dp_stat$IS_aR2, dy_stat$IS_aR2, ltr_stat$IS_aR2, ep_stat$IS_aR2,
    bm_stat$IS_aR2, ik_stat$IS_aR2, ntis_stat$IS_aR2, eqis_stat$IS_aR2
  ) * 100,
  
  OOS_aR2 = c(
    dfy_stat$OOS_aR2, infl_stat$OOS_aR2, svar_stat$OOS_aR2, de_stat$OOS_aR2,
    lty_stat$OOS_aR2, tms_stat$OOS_aR2, tbl_stat$OOS_aR2, dfr_stat$OOS_aR2,
    dp_stat$OOS_aR2, dy_stat$OOS_aR2, ltr_stat$OOS_aR2, ep_stat$OOS_aR2,
    bm_stat$OOS_aR2, ik_stat$OOS_aR2, ntis_stat$OOS_aR2, eqis_stat$OOS_aR2
  ) * 100,
  
  dRMSE = c(
    dfy_stat$dRMSE, infl_stat$dRMSE, svar_stat$dRMSE, de_stat$dRMSE,
    lty_stat$dRMSE, tms_stat$dRMSE, tbl_stat$dRMSE, dfr_stat$dRMSE,
    dp_stat$dRMSE, dy_stat$dRMSE, ltr_stat$dRMSE, ep_stat$dRMSE,
    bm_stat$dRMSE, ik_stat$dRMSE, ntis_stat$dRMSE, eqis_stat$dRMSE
  ) * 100
)

# Display table
datatable(table1, 
          options = list(pageLength = 16, dom = 't'),
          caption = "Table 1: Predictive Performance (Extended to 2018)") %>%
  formatRound(columns = c('IS_aR2', 'OOS_aR2', 'dRMSE'), digits = 2)
```

## 9.2 Comparison with Original 2005 Results

```{r comparison-table}
table1_comparison <- tibble(
  Variable = table1$Variable,
  IS_aR2_2018 = table1$IS_aR2,
  IS_aR2_2005 = table1_2005_g_w$`IS_aR2*`,
  OOS_aR2_2018 = table1$OOS_aR2,
  OOS_aR2_2005 = table1_2005_g_w$`OOS_aR2*`,
  dRMSE_2018 = table1$dRMSE,
  dRMSE_2005 = table1_2005_g_w$`dRMSE*`
)

datatable(table1_comparison,
          options = list(pageLength = 16, dom = 't'),
          caption = "Comparison: 2018 Results vs. Original 2005 Results") %>%
  formatRound(columns = 2:7, digits = 2) %>%
  formatStyle(columns = c('OOS_aR2_2018', 'OOS_aR2_2005'),
              backgroundColor = styleInterval(0, c('#ffcccc', '#ccffcc')))
```

## 9.3 Out-of-Sample MSE Table

```{r mse-table}
mse_table <- tibble(
  Variable = c("dfy", "infl", "svar", "d/e", "lty", "tms", "tbl", "dfr", 
               "d/p", "d/y", "ltr", "e/p", "b/m", "i/k", "ntis", "eqis"),
  
  MSE_Historical_Mean = c(
    dfy_stat$OOS_MSE_N, infl_stat$OOS_MSE_N, svar_stat$OOS_MSE_N, de_stat$OOS_MSE_N,
    lty_stat$OOS_MSE_N, tms_stat$OOS_MSE_N, tbl_stat$OOS_MSE_N, dfr_stat$OOS_MSE_N,
    dp_stat$OOS_MSE_N, dy_stat$OOS_MSE_N, ltr_stat$OOS_MSE_N, ep_stat$OOS_MSE_N,
    bm_stat$OOS_MSE_N, ik_stat$OOS_MSE_N, ntis_stat$OOS_MSE_N, eqis_stat$OOS_MSE_N
  ),
  
  MSE_OLS = c(
    dfy_stat$OOS_MSE_A, infl_stat$OOS_MSE_A, svar_stat$OOS_MSE_A, de_stat$OOS_MSE_A,
    lty_stat$OOS_MSE_A, tms_stat$OOS_MSE_A, tbl_stat$OOS_MSE_A, dfr_stat$OOS_MSE_A,
    dp_stat$OOS_MSE_A, dy_stat$OOS_MSE_A, ltr_stat$OOS_MSE_A, ep_stat$OOS_MSE_A,
    bm_stat$OOS_MSE_A, ik_stat$OOS_MSE_A, ntis_stat$OOS_MSE_A, eqis_stat$OOS_MSE_A
  )
) %>%
  mutate(MSE_Reduction = (MSE_Historical_Mean - MSE_OLS) / MSE_Historical_Mean * 100)

datatable(mse_table,
          options = list(pageLength = 16, dom = 't'),
          caption = "Out-of-Sample Mean Squared Error Comparison") %>%
  formatRound(columns = 2:4, digits = 4)
```

---

# 10. Key Findings and Interpretation

## 10.1 Main Results

### In-Sample Performance
Most predictors show **positive in-sample R²**, suggesting they fit historical data well. This confirms that these variables are correlated with equity returns historically.

### Out-of-Sample Performance
**Critical Finding:** Nearly all predictors have **negative or near-zero out-of-sample R²**, meaning they fail to beat the simple historical mean forecast when tested on new data.

### Interpretation

1. **Overfitting**: Strong in-sample performance but weak OOS performance suggests models are overfitting to historical patterns that don't persist out-of-sample.

2. **Data Mining**: The apparent predictability may result from extensive searching through many variables over the same historical period.

3. **Regime Changes**: Economic relationships may not be stable over time, causing predictors that worked historically to fail going forward.

## 10.2 Plot Interpretation

The cumulative SSE difference plots show:
- **Positive slope**: Predictor beats historical mean (reduces cumulative error)
- **Negative slope**: Historical mean beats predictor (predictor makes things worse)
- **Flat line**: No difference between methods

**Key Observation:** Most OOS lines (red) trend downward or remain flat, indicating predictors fail to add value out-of-sample.

## 10.3 Practical Implications

1. **For Investors**: Simple historical mean forecasts are difficult to beat systematically
2. **For Researchers**: Be cautious about in-sample evidence of predictability
3. **For Practitioners**: Out-of-sample testing is essential before deploying any predictive model

---

# 11. Conclusion

This replication of Goyal & Welch (2008) confirms their key finding: **commonly used financial variables have little out-of-sample predictive power for equity returns**, despite strong in-sample performance.

The analysis extended through 2018 shows these results are robust over time, reinforcing skepticism about equity premium predictability.

**Key Takeaway:** In-sample predictability ≠ Out-of-sample predictability. Always validate models on out-of-sample data before drawing conclusions about genuine forecasting ability.

---

# References

Goyal, A., & Welch, I. (2008). A Comprehensive Look at The Empirical Performance of Equity Premium Prediction. *Review of Financial Studies*, 21(4), 1455-1508.

---

# Appendix: Session Info

```{r session-info}
sessionInfo()
```
